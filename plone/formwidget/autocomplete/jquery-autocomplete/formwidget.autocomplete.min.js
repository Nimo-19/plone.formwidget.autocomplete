!function(){"use strict";var e;(e=jQuery).fn.extend({autocomplete:function(t,a){var n="string"==typeof t;return(a=e.extend({},e.Autocompleter.defaults,{url:n?t:null,data:n?null:t,delay:n?e.Autocompleter.defaults.delay:10,max:a&&!a.scroll?10:150},a)).highlight=a.highlight||function(e){return e},a.formatMatch=a.formatMatch||a.formatItem,this.each((function(){new e.Autocompleter(this,a)}))},result:function(e){return this.bind("result",e)},search:function(e){return this.trigger("search",[e])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(e){return this.trigger("setOptions",[e])},unautocomplete:function(){return this.trigger("unautocomplete")}}),e.Autocompleter=function(t,a){var n,r,i,o={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8},l=e(t).attr("autocomplete","off").addClass(a.inputClass),s="",u=e.Autocompleter.Cache(a),c=0,f={mouseDownOnSelect:!1},h=e.Autocompleter.Select(a,t,m,f),d=-1!=navigator.userAgent.indexOf("Opera");function m(){var e=h.selected();if(!e)return!1;var t=e.result;if(s=t,a.multiple){var n=g(l.val());n.length>1&&(t=n.slice(0,n.length-1).join(a.multipleSeparator)+a.multipleSeparator+t),t+=a.multipleSeparator}return l.val(t),C(),l.trigger("result",[e.data,e.value]),!0}function p(e,t){if(r!=o.DEL){var n=l.val();(t||n!=s)&&(s=n,(n=v(n)).length>=a.minChars?(l.addClass(a.loadingClass),a.matchCase||(n=n.toLowerCase()),A(n,b,C)):(w(),h.hide()))}else h.hide()}function g(t){if(!t)return[""];var n=t.split(a.multipleSeparator),r=[];return e.each(n,(function(t,a){e.trim(a)&&(r[t]=e.trim(a))})),r}function v(e){if(!a.multiple)return e;var t=g(e);return t[t.length-1]}function C(){var r=h.visible();h.hide(),clearTimeout(n),w(),a.mustMatch&&l.search((function(e){if(!e)if(a.multiple){var t=g(l.val()).slice(0,-1);l.val(t.join(a.multipleSeparator)+(t.length?a.multipleSeparator:""))}else l.val("")})),r&&e.Autocompleter.Selection(t,t.value.length,t.value.length)}function b(n,i){i&&i.length&&c?(w(),h.display(i,n),function(n,i){a.autoFill&&v(l.val()).toLowerCase()==n.toLowerCase()&&r!=o.BACKSPACE&&(l.val(l.val()+i.substring(v(s).length)),e.Autocompleter.Selection(t,s.length,s.length+i.length))}(n,i[0].value),h.show()):C()}function A(n,r,i){a.matchCase||(n=n.toLowerCase());var o=u.load(n);if(o&&o.length)r(n,o);else if("string"==typeof a.url&&a.url.length>0){var l={timestamp:+new Date};e.each(a.extraParams,(function(e,t){l[e]="function"==typeof t?t():t})),e.ajax({mode:"abort",port:"autocomplete"+t.name,dataType:a.dataType,url:a.url,data:e.extend({q:v(n),limit:a.max},l),success:function(t){var i=a.parse&&a.parse(t)||function(t){for(var n=[],r=t.split("\n"),i=0;i<r.length;i++){var o=e.trim(r[i]);o&&(o=o.split("|"),n[n.length]={data:o,value:o[0],result:a.formatResult&&a.formatResult(o,o[0])||o[0]})}return n}(t);u.add(n,i),r(n,i)}})}else h.emptyList(),i(n)}function w(){l.removeClass(a.loadingClass)}d&&e(t.form).bind("submit.autocomplete",(function(){if(i)return i=!1,!1})),l.bind((d?"keypress":"keydown")+".autocomplete",(function(t){switch(r=t.keyCode,t.keyCode){case o.UP:t.preventDefault(),h.visible()?h.prev():p(0,!0);break;case o.DOWN:t.preventDefault(),h.visible()?h.next():p(0,!0);break;case o.PAGEUP:t.preventDefault(),h.visible()?h.pageUp():p(0,!0);break;case o.PAGEDOWN:t.preventDefault(),h.visible()?h.pageDown():p(0,!0);break;case a.multiple&&","==e.trim(a.multipleSeparator)&&o.COMMA:case o.TAB:case o.RETURN:if(m())return t.preventDefault(),i=!0,!1;break;case o.ESC:h.hide();break;default:clearTimeout(n),n=setTimeout(p,a.delay)}})).focus((function(){c++})).blur((function(){c=0,f.mouseDownOnSelect||(clearTimeout(n),n=setTimeout(C,200))})).click((function(){c++>1&&!h.visible()&&p(0,!0)})).bind("search",(function(){var t=arguments.length>1?arguments[1]:null;function a(e,a){var n;if(a&&a.length)for(var r=0;r<a.length;r++)if(a[r].result.toLowerCase()==e.toLowerCase()){n=a[r];break}"function"==typeof t?t(n):l.trigger("result",n&&[n.data,n.value])}e.each(g(l.val()),(function(e,t){A(t,a,a)}))})).bind("flushCache",(function(){u.flush()})).bind("setOptions",(function(){e.extend(a,arguments[1]),"data"in arguments[1]&&u.populate()})).bind("unautocomplete",(function(){h.unbind(),l.unbind(),e(t.form).unbind(".autocomplete")}))},e.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:!1,matchSubset:!0,matchContains:!1,cacheLength:10,max:100,mustMatch:!1,extraParams:{},selectFirst:!0,formatItem:function(e){return e[0]},formatMatch:null,autoFill:!1,width:0,multiple:!1,multipleSeparator:", ",highlight:function(e,t){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+t.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:!0,scrollHeight:180},e.Autocompleter.Cache=function(t){var a={},n=0;function r(e,a){t.matchCase||(e=e.toLowerCase());var n=e.indexOf(a);return-1!=n&&(0==n||t.matchContains)}function i(e,r){n>t.cacheLength&&l(),a[e]||n++,a[e]=r}function o(){if(!t.data)return!1;var a={},n=0;t.url||(t.cacheLength=1),a[""]=[];for(var r=0,o=t.data.length;r<o;r++){var l=t.data[r];l="string"==typeof l?[l]:l;var s=t.formatMatch(l,r+1,t.data.length);if(!1!==s){var u=s.charAt(0).toLowerCase();a[u]||(a[u]=[]);var c={value:s,data:l,result:t.formatResult&&t.formatResult(l)||s};a[u].push(c),n++<t.max&&a[""].push(c)}}e.each(a,(function(e,a){t.cacheLength++,i(e,a)}))}function l(){a={},n=0}return setTimeout(o,25),{flush:l,add:i,populate:o,load:function(i){if(!t.cacheLength||!n)return null;if(!t.url&&t.matchContains){var o=[];for(var l in a)if(l.length>0){var s=a[l];e.each(s,(function(e,t){r(t.value,i)&&o.push(t)}))}return o}if(a[i])return a[i];if(t.matchSubset)for(var u=i.length-1;u>=t.minChars;u--)if(s=a[i.substr(0,u)])return o=[],e.each(s,(function(e,t){r(t.value,i)&&(o[o.length]=t)})),o;return null}}},e.Autocompleter.Select=function(t,a,n,r){var i,o,l,s,u={ACTIVE:"ac_over"},c=-1,f="",h=!0;function d(e){for(var t=e.target;t&&"LI"!=t.tagName;)t=t.parentNode;return t||[]}function m(e){i.slice(c,c+1).removeClass(u.ACTIVE),function(e){(c+=e)<0?c=i.size()-1:c>=i.size()&&(c=0)}(e);var a=i.slice(c,c+1).addClass(u.ACTIVE);if(t.scroll){var n=0;i.slice(0,c).each((function(){n+=this.offsetHeight})),n+a[0].offsetHeight-s.scrollTop()>s[0].clientHeight?s.scrollTop(n+a[0].offsetHeight-s.innerHeight()):n<s.scrollTop()&&s.scrollTop(n)}}function p(){s.empty();for(var a,n=(a=o.length,t.max&&t.max<a?t.max:a),r=0;r<n;r++)if(o[r]){var l=t.formatItem(o[r].data,r+1,n,o[r].value,f);if(!1!==l){var h=e("<li/>").html(t.highlight(l,f)).addClass(r%2==0?"ac_even":"ac_odd").appendTo(s)[0];e.data(h,"ac_data",o[r])}}i=s.find("li"),t.selectFirst&&(i.slice(0,1).addClass(u.ACTIVE),c=0),e.fn.bgiframe&&s.bgiframe()}return{display:function(i,m){h&&(l=e("<div/>").hide().addClass(t.resultsClass).css("position","absolute").appendTo(document.body),s=e("<ul/>").appendTo(l).mouseover((function(t){d(t).nodeName&&"LI"==d(t).nodeName.toUpperCase()&&(c=e("li",s).removeClass(u.ACTIVE).index(d(t)),e(d(t)).addClass(u.ACTIVE))})).click((function(t){return e(d(t)).addClass(u.ACTIVE),n(),a.focus(),!1})).mousedown((function(){r.mouseDownOnSelect=!0})).mouseup((function(){r.mouseDownOnSelect=!1})),t.width>0&&l.css("width",t.width),h=!1),o=i,f=m,p()},next:function(){m(1)},prev:function(){m(-1)},pageUp:function(){m(0!=c&&c-8<0?-c:-8)},pageDown:function(){c!=i.size()-1&&c+8>i.size()?m(i.size()-1-c):m(8)},hide:function(){l&&l.hide(),i&&i.removeClass(u.ACTIVE),c=-1},visible:function(){return l&&l.is(":visible")},current:function(){return this.visible()&&(i.filter("."+u.ACTIVE)[0]||t.selectFirst&&i[0])},show:function(){var n=e(a).offset();if(l.css({width:"string"==typeof t.width||t.width>0?t.width:e(a).width(),top:n.top+a.offsetHeight,left:n.left}).show(),t.scroll&&(s.scrollTop(0),s.css({maxHeight:t.scrollHeight,overflow:"auto"}),1!=navigator.userAgent.indexOf("MSIE")&&void 0===document.body.style.maxHeight)){var r=0;i.each((function(){r+=this.offsetHeight}));var o=r>t.scrollHeight;s.css("height",o?t.scrollHeight:r),o||i.width(s.width()-parseInt(i.css("padding-left"))-parseInt(i.css("padding-right")))}},selected:function(){var t=i&&i.filter("."+u.ACTIVE).removeClass(u.ACTIVE);return t&&t.length&&e.data(t[0],"ac_data")},emptyList:function(){s&&s.empty()},unbind:function(){l&&l.remove()}}},e.Autocompleter.Selection=function(e,t,a){if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveStart("character",t),n.moveEnd("character",a),n.select()}else e.setSelectionRange?e.setSelectionRange(t,a):e.selectionStart&&(e.selectionStart=t,e.selectionEnd=a);e.focus()}}();